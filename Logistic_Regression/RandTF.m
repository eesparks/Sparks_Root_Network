%Input TF Expression in Different Tissues. Random Set of GT-TFs

Rand1 = [0.557512579	0.661071223	1.050669499	0.639005045	0.945215154	0.556802938	1.05992677	0.830710695	0.915508246	1.032704645	0.866516408	0.983382779	0.605428508	0.660034086	0.57659042	1.393847008	0.804142358	0.709579648	0.797033688	0.687664944	0.570859409	0.844021803	0.918889008]';
Rand2 = [2.341359067	1.27321823	0.834354184	1.173341763	1.057917703	3.20644508	0.815131672	2.181378163	1.607394808	1.281923721	1.251113441	1.385741358	1.6168226	1.694734497	4.435370853	1.121327751	0.624825863	1.001163602	0.965978608	1.620043633	2.708787827	1.709617414	1.179073908]';
Rand3 = [0.420755625	0.44976276	0.490623153	0.442397491	0.425300563	0.47491761	0.563745376	0.469965527	0.501123039	0.424292137	0.604940031	0.515518912	0.447529026	0.334978519	0.439817799	0.453088022	0.527895964	0.529772138	0.494840674	0.395331283	0.408577208	0.487052563	0.665463083]';
Rand4 = [3.431739128	4.333336384	4.458547599	2.445145099	0.911007734	1.2326775	6.832110056	0.875981011	1.504682379	3.376213664	2.67190524	1.073344024	0.794619768	6.996498979	0.745859358	7.229603443	0.742421547	1.399700161	4.237169296	3.900251126	2.9237109	1.893291837	0.979194171]';
Rand5 = [0.977476029	0.879846344	0.869533697	1.280945805	1.453862919	1.907224336	1.203198864	1.619977564	1.810793713	1.951744808	1.351324208	1.521760422	1.087573634	2.042045697	0.775495552	1.821943469	1.045665029	1.010421581	1.244262579	0.86819407	3.212377589	1.920819118	1.127830351]';
Rand6 = [0.79059716	0.596638542	0.838068001	1.262670256	2.094278031	0.668390736	1.153757248	0.761872127	1.134856681	0.634160412	0.769834825	0.826218269	0.615480767	0.571328159	0.60546636	0.667310898	0.694949035	0.671553777	1.023478632	0.652601241	0.595929525	0.762947997	0.849390783]';
Rand7 = [1.298858733	0.885271536	0.648542218	0.515844219	0.599660744	0.770958859	0.75060323	0.697693654	0.725089024	0.603316971	0.686450413	0.806868364	1.004400293	0.641551332	1.461908195	0.599201136	0.701299214	1.825871811	0.699324546	0.699369502	0.705922622	0.848049208	0.871254834]';
Rand8 = [0.636199808	0.487870098	0.484282131	0.730554158	0.501723685	0.794270752	0.443559391	0.690793677	0.455677714	0.454593365	0.53385228	0.462385709	0.621053991	0.577000106	0.748584316	0.629835359	0.514291506	0.531524239	0.448863547	0.54774231	0.787613371	0.533931755	0.55750557]';
Rand9 = [0.460600378	0.436500929	0.456200023	0.432141598	0.422114908	0.49357788	0.526097838	0.580294691	0.57130005	0.444536552	0.626368347	0.588844024	0.441641623	0.38316047	0.363914408	0.449909684	0.516178492	0.504340402	0.547304002	0.458561864	0.420714516	0.559192628	0.711483333]';
Rand10 = [0.556915904	0.588191324	0.663830361	0.48553157	0.523321742	0.543898714	0.693090887	0.672555978	0.682698388	0.552979856	0.676772334	0.724189926	0.571815307	0.481079286	0.567293271	0.601666578	0.648260722	0.650803462	0.728928008	0.527395654	0.521621169	0.669164365	0.730997508]';
Rand11 = [1.986906769	1.674921943	4.618444156	6.056067013	4.332363019	0.979138831	2.060737045	2.506553404	0.711525711	0.616208184	0.723640532	0.760449228	0.950258311	1.447601671	0.668139896	2.954435313	0.859870535	0.929568498	0.948881798	1.732755835	2.457968383	1.55548541	0.897894279]';
Rand12 = [0.800152903	3.042778122	0.601932495	0.641591239	0.94255345	1.091234873	0.692767493	1.691593636	1.199835008	0.606234737	0.710102609	1.070221765	0.623038809	0.566649972	2.036205023	0.535524671	0.604527795	3.023842359	0.855592591	0.870448204	1.712417856	1.31029447	1.023871927]';
Rand13 = [1.11450045	0.849781851	0.815576579	0.834130091	0.89479876	0.897902455	0.927202472	0.828020246	0.635968727	0.825708106	0.825232182	0.632248056	1.343170753	1.355594544	1.159005171	1.21342306	1.024381792	0.947163827	0.916545852	0.965213343	0.830746008	0.841202715	0.674422498]';
Rand14 = [0.798282209	0.694548739	0.881169585	0.542258755	0.710084663	0.650264767	0.870751575	0.90373801	0.854128017	0.716157228	0.939678363	0.916670376	0.726808768	0.67086034	0.784119961	0.72732685	0.864522933	0.888046578	0.882867025	0.706044831	0.979385033	0.935789824	0.916296319]';
Rand15 = [0.586786996	0.603992459	0.642273873	0.481736392	0.554594003	0.568713858	0.693667141	0.634052713	0.676613431	0.558040018	0.726485057	0.735109886	0.520682763	0.527632647	0.489968842	0.537195386	0.646132284	0.657106536	0.679759523	0.562064853	0.494411077	0.688774446	0.798745172]';

%Output of ON/OFF SHR Expression
%AT4G37650	
SHR = [2.572410761	1.335878503	0.600895446	0.879655858	0.656900662	1.629102242	1.842449359	0.614947469	1.044754819	2.500270392	2.46623933	0.692336398	0.583916562	2.735033417	15.08496838	1.484722125	1.462660944	1.235615815	0.950043278	1.095619029	0.50830165	1.53995961	4.784230617];
%SHR(SHR<1.5)=0

%Binary output. 0=OFF, 1=ON
SHR_Outcome = [0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	0	0	0	0	1];


X = horzcat (Rand1,Rand2,Rand3,Rand4,Rand5,Rand6,Rand7,Rand8,Rand9,Rand10,Rand11,Rand12,Rand13,Rand14,Rand15);
Y= SHR_Outcome;
Y= transpose(Y);


B = glmfit(X, [Y ones(23,1)],'binomial', 'link', 'logit');
Z = Logistic(B(1) + X(:,1) * (B(2)) + X(:,2) * (B(3)) + X(:,3) * (B(4)) + X(:,4) * (B(5)) + X(:,5) * (B(6)) + X(:,6) * (B(7)) + X(:,7) * (B(8)) + X(:,8) * (B(9)) + X(:,9) * (B(10)) + X(:,10) * (B(11)) + X(:,11) * (B(12)) + X(:,12) * (B(13)) + X(:,13) * (B(14)) + X(:,14) * (B(15)) + X(:,15) * (B(16)));
