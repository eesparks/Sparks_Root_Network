%Logistic Regression Testing

%Input TF Expression in Different Tissues. Set Repressors as negative.

%AT1G12610 - DDF1 Repressor
R1 = [-1.109194152	-2.606214408	-0.703915292	-2.490482846	-3.619554198	-0.94272734	-2.596889348	-0.952324658	-0.943958539	-3.591124753	-1.076785867	-1.069907623	-1.572628827	-6.072031816	-0.900314263	-13.52786616	-1.729673608	-0.993429628	-0.96568081	-3.395138716	-0.922841325	-1.077604193	-0.778244425]';
%R1(R1>-1.5)=0

%AT2G22840 - GRF1 Repressor
R2 = [-1.039343286	-3.760491597	-0.681732424	-0.866153305	-1.334492982	-1.903824751	-0.744814816	-2.285560848	-1.071420301	-0.620571342	-0.76269902	-0.952335922	-0.605497069	-0.621792156	-3.144140213	-0.558475499	-0.721597311	-7.848234288	-1.138343398	-1.188565634	-1.968688859	-1.309953239	-1.121482892]';
%R2(R2>-1.5)=0

%AT2G31230 - ERF15 Repressor
R3 = [-0.600594085	-0.488531535	-0.73848305	-1.045186361	-0.989437877	-0.676159695	-1.260376026	-0.539560672	-0.536509052	-0.596433078	-0.61267362	-0.632608482	-0.486847381	-0.482944494	-0.424908197	-0.861859992	-0.686219565	-0.542342699	-0.761151085	-0.700857387	-0.395912422	-0.533702195	-0.66033139]';
%R3(R3>-1.5)=0

%AT2G44730 - Repressor
R5 = [-0.835102615	-1.018871452	-0.878457449	-1.409142276	-1.005390841	-0.850811299	-1.156492486	-0.764994202	-0.734882341	-0.846849066	-0.785021472	-0.719229666	-1.286196334	-1.211168698	-1.811751266	-1.403386278	-1.765172113	-0.977345424	-0.755303827	-0.90997657	-0.800764682	-0.810668383	-0.756193659]';
%R5(R5>-1.5)=0

%AT3G21175 - ZML1 Repressor
R6 = [-1.421890485	-1.011611452	-1.283074969	-1.254401848	-1.0167134	-1.651173112	-1.033587585	-0.898899574	-0.915658983	-1.178107521	-1.102832568	-0.833261746	-1.324099248	-1.420023953	-1.845234839	-1.218620605	-0.810147624	-1.082637211	-0.955761842	-1.180350749	-1.312077808	-0.985580498	-0.986797036]';
%R6(R6>-1.5)=0

%AT3G24520 - HSFC1 Repressor
R7 = [-5.690051495	-4.403144003	-1.317511545	-2.82100805	-3.025253606	-1.883358804	-5.69489226	-1.570918368	-1.853780678	-4.890058214	-2.044113334	-1.55875295	-2.666527285	-9.349195542	-2.906873941	-6.665484485	-0.902049066	-2.503092851	-1.098174175	-6.247316891	-1.285231434	-1.582207832	-1.365260942]';
%R7(R7>-1.5)=0

%AT4G17490 - ERF6 Repressor
R8 = [-5.783664392	-10.4591601	-14.28272944	-10.01532917	-6.393923578	-2.633661645	-16.08318865	-4.937084432	-4.582116233	-5.658633599	-2.778993412	-6.870994731	-22.02097253	-12.05929668	-2.315470816	-12.43709579	-5.604084563	-5.522289794	-3.324548405	-11.75992201	-4.25336078	-3.712629692	-3.940594492]';
%R8(R8>-1.5)=0

%AT4G36730 - GBF1 Repressor
R9 = [-2.027038044	-1.648290803	-1.970688958	-2.083306633	-1.981066744	-1.571401834	-1.940773134	-1.674501712	-1.631806854	-1.695057879	-1.404722564	-1.861829801	-2.011539324	-3.576789267	-2.25600379	-2.251751843	-1.998251901	-1.253301155	-1.362391507	-1.826416391	-3.023443288	-1.253556376	-1.37353301]';
%R9(R9>-1.5)=0

%AT5G61590 = DEWAX Repressor
R10 = [-0.757847543	-2.07973462	-0.783800577	-3.144406181	-1.680870192	-0.592289703	-1.941902491	-0.85675948	-0.757984574	-0.606186253	-0.672294936	-0.822411255	-0.548174199	-1.819093929	-0.688933554	-2.400981349	-1.823666029	-1.356222698	-0.773967118	-2.696581881	-0.662663458	-0.875257252	-0.795443073]';
%R10(R10>-1.5)=0

%AT1G61730 - STK01 Activator
A1 = [5.964449418	6.896031439	4.622665159	6.00615493	4.030852823	11.72644178	5.35924383	3.070852927	2.766576716	6.666649657	3.704476824	2.367823502	5.120444039	5.933735344	10.83318341	7.982871436	3.991560568	7.343629222	2.545061486	5.699171736	4.397227973	3.125286694	3.228333972]';
%A1(A1<1.5)=0

%AT1G71130 - CRF8 Activator
A2 = [1.53243343	1.909285014	0.996486763	2.94891555	1.17160556	0.955437734	3.22235197	0.808488017	1.049616996	2.021071865	1.166860203	1.041116595	1.871593509	1.286172854	1.632492637	2.48918163	1.513620386	1.782585008	1.653158515	1.820298409	0.786297787	1.069920593	1.283009513]';
%A2(A2<1.5)=0

%AT1G76880 - DF1 Activator
A3 = [1.040052586	1.197969807	1.911116386	1.320167278	1.843703305	1.060840589	1.117778855	1.360099155	1.601992948	1.747419188	1.416098667	1.301953551	1.192796744	1.260350787	1.361736236	1.356165522	0.993614549	1.150727633	1.3779129	1.144616657	2.203556953	1.060679844	1.104926648]';
%A3(A3<1.5)=0

%AT3G19290 - AREB2 Activator
A4 = [1.107987146	0.902998716	0.974069534	2.06342262	1.161788979	0.927479911	1.006924992	0.837495985	1.029846172	1.139300652	1.274398841	0.965326162	1.031409544	1.117141808	1.785274529	1.451467681	2.413181255	0.826418619	0.971240509	1.224142918	0.887583839	0.997894701	1.313527289]';
%A4(A4<1.5)=0

%AT5G05410 - DREB2A Activator
A5 = [30.29846999	32.59666392	38.31152174	53.90065563	30.75740564	16.80945408	44.54440956	19.93101713	8.201429702	18.66796599	12.13792165	11.49482813	29.63534521	34.65177996	13.93939347	39.63981173	35.44483182	27.63210465	13.97788252	34.86305119	18.41400636	12.78392521	6.070078446]';
%A5(A5<1.5)=0

%Output of ON/OFF SHR Expression
%AT4G37650	
SHR = [2.572410761	1.335878503	0.600895446	0.879655858	0.656900662	1.629102242	1.842449359	0.614947469	1.044754819	2.500270392	2.46623933	0.692336398	0.583916562	2.735033417	15.08496838	1.484722125	1.462660944	1.235615815	0.950043278	1.095619029	0.50830165	1.53995961	4.784230617];
%SHR(SHR<1.5)=0

%Binary output. 0=OFF, 1=ON
SHR_Outcome = [0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	0	0	0	0	1];

%Combine Data:
X = horzcat (A1,A2,A3,A4,A5,R1,R2,R3,R5,R6,R7,R8,R9,R10);

%Y contains the target variable. 0 or 1 depending on the outcome. Here 0 is
%OFF and 1 is ON
Y= SHR_Outcome;
Y= transpose(Y);

n=1;

B = glmfit(X, [Y ones(23,1)],'binomial', 'link', 'logit');
Z = Logistic(B(1) + X(:,1) * (B(2)) + X(:,2) * (B(3)) + X(:,3) * (B(4)) + X(:,4) * (B(5)) + X(:,5) * (B(6)) + X(:,6) * (B(7)) + X(:,7) * (B(8)) + X(:,8) * (B(9)) + X(:,9) * (B(10)) + X(:,10) * (B(11)) + X(:,11) * (B(12)) + X(:,12) * (B(13))+ X(:,13) * (B(14))+ X(:,14) * (B(15)));



%scores = B.Fitted.Probability;
%[X,Y,T,AUC] = perfcurve(Y,scores,'1');
%AUC is 1 - we can recover the input exactly, but this doesn't tell me how
%it functions as a predictor...


% prediction function given training/testing instances
fcn = @(Xtr, Ytr, Xte) predict(...
    GeneralizedLinearModel.fit(Xtr,Ytr,'linear', 'Distribution', 'binomial', 'link', 'logit'), ...
    Xte);

 %perform cross-validation, and return average MSE across folds
mse = crossval('mse', X, Y, 'Predfun',fcn, 'kfold',10);

% compute root mean squared error
avg_rmse = sqrt(mse)


